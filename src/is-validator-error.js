'use strict'

const { BaseError } = require('./errors')

/**
 * @description Checks if the given error was generated by this library.
 *
 * @param {Error} err - An instance of an error.
 *
 * @returns {boolean} Returns true if the error was generated by this library.
 * Otherwise returns false.
 *
 * @example
 *
 * 'use strict';
 *
 * const { AWSCognitoJWTValidator, isAWSCognitoJWTValidatorError } = require('aws-cognito-express');
 *
 * const validator = new AWSCognitoJWTValidator({ ... });
 * const token = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...';
 *
 * const err = new Error('Unexpected error');
 * isAWSCognitoJWTValidatorError(err);
 * // => false
 *
 * validator.validate(token)
 *  .catch((err) => {
 *    isAWSCognitoJWTValidatorError(err);
 *    // => true
 *  });
 * */
function isAWSCognitoJWTValidatorError(err) {
  return err instanceof BaseError && err.isAWSCognitoJWTValidatorError === true
}

module.exports = isAWSCognitoJWTValidatorError
